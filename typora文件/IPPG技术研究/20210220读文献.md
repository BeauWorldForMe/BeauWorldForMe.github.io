## 评估iPPG脉率变异性的频谱估计方法

Spectral Estimation Methods for Evaluating iPPG Pulse Rate Variability

**非接触测量应用于工作场所的压力测量**

使用非接触式成像方法捕获的脉冲信号通常非常微妙，容易受到头部运动，周围光线变化，面部表情和谈话的破坏。因此，对不均匀采样和/或丢失的数据执行良好的光谱分析方法是有益的。



## 远距离运动中的稳健成像光电容积描记

**可调整远近，距离更改下的IPPG技术**，精确度在物体距离较远时会迅速降低

2011年，Lewandowska [7]确定，与ICA相比，主成分分析更快而又不影响准确性。

对象的运动在实际测量中更为复杂。当敏感区域发生剧烈变化时，例如当对象处于步行运动中并且对象与相机之间的距离发生显着变化时，现有的运动去除伪影算法将无效。

## 基于视频的脉冲到达时间对动态血压变化的敏感性

这项研究的目的是量化iPPG-PTT对BP动态期的敏感性，以评估iPPG-PTT是否确实可以追踪BP的变化。

**所有视频和信号处理均使用MATLAB R2017a编写的自定义脚本执行。** 

Viola-Jones算法[15]用于检测和跟踪面部特征（眼睛，鼻子和嘴唇），并通过每次视频记录的长度隔离感兴趣区域（ROI）。选择并跟踪了两个ROI：对象的前额（眼睛上方的矩形区域）和对象的脸颊（眼睛下方的矩形区域，与鼻子的边界平行且在嘴唇上方）。已经提出，额头区域包含较高强度的PPG信号[16]。

使用绿色通道强度是因为血红蛋白吸收了环境光的绿色成分，并且反射的PPG随着通量（绿色信号的最低点）和流入量（绿色信号的峰值）而变化[17]。这在绿色通道中比红色或蓝色通道中更强的与心脏相关的脉冲中是明显的。

**尽管iPPG-PAT和BP之间的相关系数在以前的研究中有所不同，但结果在不久的将来有望用于基于图像的BP测量**

**受试者间差异的另一个可能原因是交感神经外流增加和外围血管阻力增加**，这通常是在运动过程中发生的，例如等距手柄挑战。周围血管收缩可导致皮肤表面血流量减少。已经提出，在由交感神经和副交感神经控制的面部血管中不会发生血管收缩[12]。但是，如果皮肤中的血流减少，则将提取出幅度很低的iPPG信号。尽管它可能仍包含与心脏有关的振荡，但信噪比可能会降低，基准点可能无法以与静息BP时相同的精度进行检测。

**如果从iPPG-PAT估计SBP，这将更成问题。**与DBP不同，SBP和脉压取决于其他因素，例如交感神经活动水平，心脏收缩力和大动脉顺应性[12]。未来的工作可能会调查此问题，同时还要调查使用非接触式PTT消除对ECG的需求。不管用于计算PTT（接触式传感器或iPPG）的方法如何，用PTT测量BP的最大挑战是校准[19]，[20]。根据当前研究的结果，DBP和Finger-PAT之间以及DBP和iPPG-PAT之间具有显着回归和负斜率的受试者比例没有显着差异（卡方p值=  0.19和0.38）。这意味着iPPG-PAT可以跟踪DBP的变化，与手指PAT跟踪DBP的差别不大。总体而言，iPPG-PAT和DBP之间的回归之间受试者之间存在很大的变异性。这将提出一个问题，即该技术的应用是否适合替代接触式传感器和可穿戴设备。但是，**总体队列分析显示出显着的负相关性（DBP舒张压增，PAT脉冲到达时间减）**，表明该技术可能会在未来的研究中有所改进。

## 基于视频的生理参数测量，采用峰谷法最小化初始死区

大多数传统的iPPG方法通过对具有固定大小的移动时间滑动窗口中的信号迹线进行频率或频谱分析来提取生理参数。在这种情况下，为了使由于反射光或面部姿势的变动引起的噪声的影响最小，通常使窗口尺寸足够大，但是在初始测量时会引起与窗口尺寸一样多的盲区。

在选定的ROI中提取的信号迹线可以是一个通道（通常为绿色通道）的像素平均值，该平均值很好地反映了血流的吸收特性变化，或者是多个通道的合成值。

提出了一种基于峰谷的HR估计方法，该方法可应用于可变大小的滑动窗口，该方法通过从最初的小尺寸逐渐扩大到最佳窗口尺寸来最小化初始死区。

从相机输入图像时，将检测并跟踪要分析的面部区域。在这项研究中，我们使用了基于深度神经网络的面部检测器，该面部检测器使用了以ResNet为基本网络的单发检测器框架。该方法比以前研究中使用的Viola–Jones方法更快，更稳定且更准确[1]  [6]。尽管如此，它仍然容易受到诸如面部姿势变化之类的运动伪影的影响。为了解决这个问题，如先前的研究[11] [7]  [9]中所应用的光流跟踪方法。通过使用KLT算法对从面部区域提取的SURF局部特征执行**帧间光流跟踪**，可以通过计算局部特征的变化位置之间的变换矩阵来执行朝向参考面部区域的透视变形。

通过使用光流跟踪通过扭曲到参考面部区域来最小化整个面部的全局运动伪影

**通过迭代搜索窗口中大于阈值的值所包围的局部最小值和小于窗口阈值的值所包围的局部最大值来检测峰值和谷值。在此，根据经验确定搜索间隔的大小，以使可能包含在信号中的抖动噪声不会被检测为峰值或谷值。通过合并提取的峰和谷顶点来构造峰谷顶点列表**

然后使用（1）计算BPM值，该值使用列表中每个相邻顶点之间的时间间隔（Δt）的平均值。

![image-20210303172648407](C:\Users\15200\AppData\Roaming\Typora\typora-user-images\image-20210303172648407.png)

血氧饱和度计算：在这项研究中，红色和蓝色通道分别用于λ1和λ2，并且使用标准差和均值统计量计算AC和DC分量。

![image-20210308101028471](C:\Users\15200\AppData\Roaming\Typora\typora-user-images\image-20210308101028471.png)

一旦计算出R值，就利用R值和从脉搏血氧仪获得的参考SpO2测量值进行线性曲线拟合，以找到线性方程式（4）的参数b和c，以确保实际SpO2值。

![image-20210308101057079](C:\Users\15200\AppData\Roaming\Typora\typora-user-images\image-20210308101057079.png)

**指甲式血氧仪的bai工作原理du**:通过依次驱zhi动一个红光daoLED(660nm)和一个红外光LED(910nm)，蓝色线条表示血红zhuan蛋白shu不带氧分子的时候接收管对还原血红蛋白感应曲线，从曲线图中可以看下还原血红蛋白对660nm红光的吸收比较强,而对910nm红外光的吸收长度比较弱。红色线条表示血红蛋白并带有氧分子的血红细胞时接收管对氧合血红蛋白感应曲线，对660nm红光的吸收比较弱，对910nm红外光的吸收比较强。在血氧测量时，还原血红蛋白和有氧合血红蛋白，通过检测两种对不同波长的光吸收的区别，所测出来的数据差就是测量血氧饱和度最基本的数据。在血氧测试中660nm和910nm最常见的两个波长，实际上要做到更高的精度，除了两个波长以外还要增加，甚至高达8个波长，最主要的原因是人体血红蛋白除了还原血红蛋白和氧合血红蛋白之外，还有其他的血红蛋白，我们经常见的是碳氧血红蛋白，更多的波长有利于你做的精度更好。



